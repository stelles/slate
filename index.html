
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="javascripts/all.js"></script>
  </head>

  <body class="index" data-languages="[&quot;json&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="introduction">Introduction</a>
          </li>
          <li>
            <a href="#data-connector" class="toc-h1 toc-link" data-title="data-connector">Data Connector</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#fields" class="toc-h2 toc-link" data-title="fields">Fields</a>
                  </li>
                  <li>
                    <a href="#input-parameters" class="toc-h2 toc-link" data-title="input-parameters">Input Parameters</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#server-calls" class="toc-h1 toc-link" data-title="server-calls">Server Calls</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#load-data-connectors" class="toc-h2 toc-link" data-title="load-data-connectors">Load Data Connectors</a>
                  </li>
                  <li>
                    <a href="#start-data-stream" class="toc-h2 toc-link" data-title="start-data-stream">Start Data Stream</a>
                  </li>
                  <li>
                    <a href="#return-data" class="toc-h2 toc-link" data-title="return-data">Return Data</a>
                  </li>
              </ul>
          </li>
      </div>
        <ul class="toc-footer">
            <li><a href='https://github.com/lord/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>The Data Connector (DC) will be an HTTP Rest API server which the Stratifyd Web Client will push queries to the DC server and the DC server will retrieve the data based on the query and push it back to the Stratifyd server for analysis. Please look at this <a href="https://imgur.com/XLWPOsS">server flow diagram</a> for a quick understanding of how the flow will act. </p>
<h1 id='data-connector'>Data Connector</h1><h2 id='fields'>Fields</h2>
<blockquote>
<p>Example data connector looks like this.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"amazon"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"display_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Amazon"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"regex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amazon</span><span class="se">\\</span><span class="s2">.[a-z]{2,3}.*</span><span class="se">\\</span><span class="s2">/([A-Z0-9]{10})"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"multi"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Amazon Item URL"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item_url"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"req"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Copy the Amazon item URL and paste it in the field. We can handle different languages."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"enabled"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"date_range"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"image_url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://beta.stratifyd.com/images/dataconnectors/icon_amazon.svg"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"roles"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"pm"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='required'>Required</h3>
<p>These fields are all required</p>

<p><code>name</code> - URL safe variable name for data connector</p>

<p><code>display_name</code> - Human readable name</p>

<p><code>params</code> - array of <a href="#input-parameters">data connector parameters</a> which control the input for the data connector.</p>

<p><code>enabled</code> - boolean to enabled/disable the data connector</p>

<p><code>date_range</code> - boolean to allow date range selection</p>

<p><code>image_url</code> - an SVG image url which will be used as the image icon</p>
<h3 id='optional'>Optional</h3>
<p>These fields are optional but allow for extra customization for the data connector</p>

<p><code>description</code> - describes what the data connector does and what data it will pull down</p>

<p><code>subdomain</code> - array of domains which will have access to the data connector (default all access)</p>

<p><code>role</code> - array of predefined roles to categorize the data connector (defaults to category all)</p>

<ul>
<li><code>cx</code> - Customer Experience</li>
<li><code>pm</code> - Product Management</li>
<li><code>research</code> - Research</li>
<li><code>hr</code> - Human Resources</li>
<li><code>marketing</code> - Marketing</li>
</ul>
<h2 id='input-parameters'>Input Parameters</h2>
<blockquote>
<p>Examples</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"regex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amazon</span><span class="se">\\</span><span class="s2">.[a-z]{2,3}.*</span><span class="se">\\</span><span class="s2">/([A-Z0-9]{10})"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"multi"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Amazon Item URL"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item_url"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"req"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Copy the Amazon item URL and paste it in the field. We can handle different languages."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Comments Only"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"comments_only"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"req"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bool"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ignore a user's self posts."</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ratings"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Specify which ratings you would like to search or none to search them all."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
          </span><span class="s2">"1"</span><span class="p">:</span><span class="w"> </span><span class="err">True</span><span class="p">,</span><span class="w">
          </span><span class="s2">"2"</span><span class="p">:</span><span class="w"> </span><span class="err">True</span><span class="p">,</span><span class="w">
          </span><span class="s2">"3"</span><span class="p">:</span><span class="w"> </span><span class="err">True</span><span class="p">,</span><span class="w">
          </span><span class="s2">"4"</span><span class="p">:</span><span class="w"> </span><span class="err">True</span><span class="p">,</span><span class="w">
          </span><span class="s2">"5"</span><span class="p">:</span><span class="w"> </span><span class="err">True</span><span class="p">,</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"req"</span><span class="p">:</span><span class="w"> </span><span class="err">False</span><span class="p">,</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"multi_bool"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ratings"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="err">'integer'</span><span class="p">,</span><span class="w">
      </span><span class="s2">"req"</span><span class="p">:</span><span class="w"> </span><span class="err">True</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Sets max number of comments to try to crawl and analyze. (Max 50,000)"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Comment Limit"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"max_comments"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"default"</span><span class="p">:</span><span class="w"> </span><span class="mi">10000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"max"</span><span class="p">:</span><span class="w"> </span><span class="mi">50000</span><span class="p">,</span><span class="w">
      </span><span class="s2">"min"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight json tab-json"><code><span class="w">    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"list"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"req"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"display_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Text Analysis"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"chat_type"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Please select if you want to analyze the agent's chat, the visitor chat or both together."</span><span class="p">,</span><span class="w">
      </span><span class="s2">"options"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"label"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Agent"</span><span class="p">,</span><span class="w">
            </span><span class="s2">"value"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"agent"</span><span class="w">
          </span><span class="p">},</span><span class="w">
          </span><span class="p">{</span><span class="w">
            </span><span class="s2">"label"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">Visitor</span><span class="s2">",
            "</span><span class="err">value</span><span class="s2">" : "</span><span class="err">visitor</span><span class="s2">"
          }
      ],
      "</span><span class="err">default</span><span class="s2">" : "</span><span class="err">Agent</span><span class="w"> </span><span class="err">and</span><span class="w"> </span><span class="err">Visitor</span><span class="s2">"
    }
</span></code></pre>
<p>These fields make up generic input parameters for the data connectors. The starred fields for each type are optional unless specfied.</p>
<h3 id='required-2'>Required</h3>
<p><code>display_name</code> - Human readable string with the parameters name</p>

<p><code>name</code> - Programatic variable used for passing the parameter between servers.</p>

<p><code>type</code> - declares what the input <a href="#parameter-types">parameter type</a> </p>

<p><code>req</code> - boolean declaring if the paramter is required</p>

<aside class="warning">The parameter names `start_date` and `end_date` are **NOT** allowed.</aside>
<h3 id='parameter-types'>Parameter    Types</h3>
<p>Each of these types is a different type of input</p>
<h4 id='string'>String</h4>
<p><code>string</code> - user passes in a string and will be returned as a string or array of strings if <code>multi : true</code>.</p>

<ul>
<li><code>regex</code> - string of regular expression for verification on the input</li>
<li><code>multi</code> - boolean modifier which allows for many strings to be passed in as well as changes return from string to array of strings.</li>
</ul>
<h4 id='boolean'>Boolean</h4>
<p><code>bool</code> - a boolean flag for the user to select</p>

<ul>
<li><code>default</code> - boolean value that the input is defaults to</li>
</ul>
<h4 id='multi-boolean'>Multi Boolean</h4>
<p><code>multi_bool</code> - a key, value of input names and boolean flags respectively</p>

<ul>
<li><code>default</code> - <em>required</em> JSON object with key,value pairs where the key is the flag and the value is a boolean</li>
</ul>
<h4 id='integer'>Integer</h4>
<p><code>int</code> - integer for the user to enter</p>

<ul>
<li><code>min</code> - integer that declares the minimum value the user can select</li>
<li><code>max</code> - integer that declares the maximum value the user can select</li>
<li><code>default</code> - default integer</li>
</ul>
<h4 id='list'>List</h4>
<p><code>list</code> - gives the user a list of pre-defined inputs to select</p>

<ul>
<li><code>options</code> - <strong>required</strong> Array of JSON objects which each contain the keys <code>label</code> and <code>value</code> where the label is the human readable string and the value is the programtatic value which will be returned</li>
<li><code>multi</code> - allows the user to select multiple entries from the options list</li>
<li><code>default</code> - string of the default <code>value</code> key inside the options array</li>
</ul>

<hr>
<h1 id='server-calls'>Server Calls</h1><pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">get</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">get</span><span class="p">(</span><span class="s">"http://localhost/external"</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>The above will return all data connectors available on this server.</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"amazon"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"display_name"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Amazon"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"params"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
          </span><span class="s2">"regex"</span><span class="p">:</span><span class="w"> </span><span class="s2">"amazon</span><span class="se">\\</span><span class="s2">.[a-z]{2,3}.*</span><span class="se">\\</span><span class="s2">/([A-Z0-9]{10})"</span><span class="p">,</span><span class="w"> 
          </span><span class="s2">"multi"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
          </span><span class="s2">"display_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Amazon Item URL"</span><span class="p">,</span><span class="w"> 
          </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"item_url"</span><span class="p">,</span><span class="w"> 
          </span><span class="s2">"req"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> 
          </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w"> 
          </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Copy the Amazon item URL and paste it in the field. We can handle different languages."</span><span class="w">
        </span><span class="p">}</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"enabled"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"Copy the Amazon Product url(s) and Stratifyd will analyze the product reviews."</span><span class="w">
      </span><span class="s2">"date_range"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"image_url"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"https://beta.stratifyd.com/images/dataconnectors/icon_amazon.svg"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"roles"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"pm"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span></code></pre>
<p>The DC HTTP Server only must handle 2 calls, a GET request for Data connector parameters and POST request that begin the data gathering process which then POST&#39;s the data back to the Stratifyd server.</p>
<h2 id='load-data-connectors'>Load Data Connectors</h2>
<p>This will be the <strong>only</strong> GET reqeuest needed for the DC server.  The response will be a JSON array of <a href="#data-connector">data connectors</a>. The endpoint will be <code>/external</code>. There will be no URL parameters or special headers.</p>
<h2 id='start-data-stream'>Start Data Stream</h2>
<p>The DC server process once the query data request is made can be found <a href="https://imgur.com/PJ9clb8">here</a>.  Please review the decision tree which the DC server should follow.</p>
<pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">post</span>

<span class="n">body</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">"start_date"</span> <span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s">"end_date"</span> <span class="p">:</span> <span class="n">null</span><span class="p">,</span>
    <span class="s">"item_url"</span> <span class="p">:</span> <span class="s">"https://www.amazon.com/gp/product/B0013JOK8K"</span>
<span class="p">}</span>

<span class="c">### These url params are important for returning data please save them</span>
<span class="n">url_params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'token'</span><span class="p">:</span>  <span class="err">$</span><span class="n">ACCESS_TOKEN</span><span class="p">,</span>
    <span class="s">'domain'</span><span class="p">:</span> <span class="n">SUBDOMAIN</span><span class="p">,</span>
    <span class="s">"id"</span><span class="p">:</span> <span class="err">$</span><span class="n">STREAM_ID</span><span class="p">,</span>
<span class="p">}</span>

<span class="n">req</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="s">"http://localhost/external/amazon"</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>
</code></pre>
<blockquote>
<p>Above request will return <a href="#stratifyd-indexes">indexes</a> for the analysis. Example response below</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"text_index"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"review_text"</span><span class="p">],</span><span class="w">
    </span><span class="s2">"date_index"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"unknown"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"review_date"</span><span class="p">,</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre><h3 id='stratifyed-indexes'>Stratifyed Indexes</h3>
<p>These indexes are used for our analysis engine to process specfic fields. The basic format is <code>index_type : field_name</code></p>

<blockquote>
<p>Example Indexes</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"text_index"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"comment"</span><span class="p">,</span><span class="w"> 
      </span><span class="s2">"title"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"date_index"</span><span class="w"> </span><span class="p">:{</span><span class="w">
      </span><span class="err">'unknown'</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="err">'review_date'</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight json tab-json"><code><span class="w">  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"geo_index"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"global"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"customer_country"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"subglobal"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"customer_state"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"local"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"customer_city"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span></code></pre><h4 id='text'>Text</h4>
<p><code>text_index</code> - array of indexes used for textual analysis</p>
<h4 id='date'>Date</h4>
<p><code>date_index</code> - nested indexes with options used for temporal analysis</p>

<ul>
<li><code>unknown</code> - field with a string of text that needs parsing into a date</li>
<li><code>timestamp</code> - either second or milisecond unix timestamp </li>
<li><code>day</code> - integer day of the month</li>
<li><code>month</code> - integer month of the year</li>
<li><code>year</code> - year </li>
</ul>
<h4 id='geo'>Geo</h4>
<p><code>geo_index</code> - nested indexes that contain fields with varying geographical information</p>

<ul>
<li><code>unknown</code> - geographical string we attempt to parse</li>
<li><code>global</code>  - country<br></li>
<li><code>subglobal</code> - state/providence </li>
<li><code>local</code> - city </li>
<li><code>sublocal</code> - street name </li>
<li><code>postcode</code> - postal code </li>
<li><code>latitude</code> - latitude column </li>
<li><code>logintude</code> - longingtude column </li>
<li><code>latitude_longitude</code> - column with lat/long in that order </li>
<li><code>longitude_latitude</code> - column with long/lat in that order </li>
<li><code>ip_address</code> - IP address column<br></li>
<li><code>phone_number</code> - phone # </li>
</ul>
<h2 id='return-data'>Return Data</h2>
<p>To return data, using the url parameters from the <a href="#start-date-stream">initial data request</a>.</p>

<p>Using the request schema, host and port from the port request along with the url parameters we can construct the return POST requests. The url will look like this <code>https://alphaapi.stratifd.com/streams/5ace79e3b2308449f3608159/documents</code>.</p>

<p>The following headers will looke like this</p>

<p>Using the following headers</p>

<ul>
<li><code>Content-Type : &#39;application/json&#39;</code></li>
<li><code>X-Taste-Tmp : ACCESS_TOKEN</code></li>
<li><code>X-Taste-App : SUBDOMAIN</code></li>
</ul>
<pre class="highlight python tab-python"><code><span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">post</span>
<span class="n">headers</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s">'Content-Type'</span> <span class="p">:</span> <span class="s">'application/json'</span><span class="p">,</span>
    <span class="s">'X-Taste-Tmp'</span> <span class="p">:</span> <span class="n">ACCESS_TOKEN</span><span class="p">,</span>
    <span class="s">'X-Taste-App'</span> <span class="p">:</span> <span class="n">SUBDOMAIN</span>
<span class="p">}</span>
<span class="n">url</span> <span class="o">=</span> <span class="s">"https://alphaapi.stratifyd.com/streams/</span><span class="si">%</span><span class="s">s/documents"</span> <span class="o">%</span> <span class="err">$</span><span class="n">STREAM_ID</span>
<span class="n">body</span> <span class="o">=</span> <span class="p">[</span><span class="n">doc1</span><span class="p">,</span> <span class="n">doc2</span><span class="p">,</span> <span class="n">doc3</span><span class="p">]</span> 
<span class="n">req</span> <span class="o">=</span> <span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">headers</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">body</span><span class="p">)</span>
</code></pre>
<aside class="warning">
If status code of post request isn't <code>200</code> please end the stream.
</aside>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
          </div>
      </div>
    </div>
  </body>
</html>
